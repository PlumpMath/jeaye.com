#!/usr/bin/env bash

cleanup()
{
  [ -z ${tmp+x} ] || rm -vrf "$tmp"
}
trap cleanup EXIT

tmp=$(mktemp -d)
mv -v _site/* "$tmp"/
cp -rv .git "$tmp"/
pushd "$tmp"
  rm -rfv ./vendor ./run ./publish ./Gemfile*
  git checkout -B gh-pages
  git add .
  git commit -am "Publish updates"
  git push -f origin HEAD
popd
